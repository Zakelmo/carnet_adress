{% extends "base.html" %}

{% set categorie = contact.categorie or 'Patient' %}

{% block title %}
{% if categorie == 'Patient' %}
Modifier un Patient - Cabinet MÃ©dical
{% elif categorie == 'Pharmacie' %}
Modifier une Pharmacie - Cabinet MÃ©dical
{% elif categorie == 'Laboratoire' %}
Modifier un Laboratoire - Cabinet MÃ©dical
{% elif categorie == 'Assurance' %}
Modifier une Assurance - Cabinet MÃ©dical
{% elif categorie == 'Fournisseur' %}
Modifier un Fournisseur - Cabinet MÃ©dical
{% elif categorie == 'Partenaire' %}
Modifier un Partenaire - Cabinet MÃ©dical
{% else %}
Modifier un Contact - Cabinet MÃ©dical
{% endif %}
{% endblock %}

{% block content %}
<div class="content-container">
    <div class="page-header">
        <h1>
            {% if categorie == 'Patient' %}
            âœï¸ Modifier un Patient
            {% elif categorie == 'Pharmacie' %}
            âœï¸ Modifier une Pharmacie
            {% elif categorie == 'Laboratoire' %}
            âœï¸ Modifier un Laboratoire
            {% elif categorie == 'Assurance' %}
            âœï¸ Modifier une Assurance
            {% elif categorie == 'Fournisseur' %}
            âœï¸ Modifier un Fournisseur
            {% elif categorie == 'Partenaire' %}
            âœï¸ Modifier un Partenaire
            {% else %}
            âœï¸ Modifier un Contact
            {% endif %}
        </h1>
        <a href="{{ url_for('contacts') }}" class="btn btn-secondary">â† Retour</a>
    </div>
    
    <div class="form-container">
        <form method="POST" action="{{ url_for('edit_contact', nom=contact.nom) }}">
            <h3>Informations de Base</h3>
            
            {% if user_role == 'user' %}
            <!-- USER: Champs en lecture seule (ne peut pas modifier l'identitÃ©) -->
            <div class="alert alert-info" style="margin-bottom: 20px; padding: 15px; background: #e7f3ff; border-radius: 5px;">
                <strong>â„¹ï¸ Information :</strong> 
                {% if categorie == 'Patient' %}
                Vous ne pouvez modifier que vos informations mÃ©dicales.
                {% else %}
                Vous ne pouvez modifier que vos informations.
                {% endif %}
                Pour modifier votre nom, email, tÃ©lÃ©phone ou catÃ©gorie, contactez un administrateur.
            </div>
            
            <div class="form-group">
                <label for="categorie">ğŸ“ CatÃ©gorie</label>
                <input type="text" value="{{ contact.categorie or 'Patient' }}" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
            </div>
            
            <div class="form-group">
                <label for="nom">
                    {% if categorie == 'Patient' %}
                    ğŸ‘¤ Nom Complet
                    {% elif categorie == 'Pharmacie' %}
                    ğŸ’Š Nom de la Pharmacie
                    {% elif categorie == 'Laboratoire' %}
                    ğŸ”¬ Nom du Laboratoire
                    {% elif categorie == 'Assurance' %}
                    ğŸ›¡ï¸ Nom de l'Assurance
                    {% elif categorie in ['Entreprise', 'Client', 'Fournisseur', 'Partenaire'] %}
                    ğŸ¢ Nom de l'Organisation
                    {% else %}
                    ğŸ‘¤ Nom
                    {% endif %}
                </label>
                <input type="text" id="nom" name="nom" value="{{ contact.nom }}" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
            </div>
            
            <div class="form-group">
                <label for="email">ğŸ“§ Email</label>
                <input type="email" id="email" name="email" value="{{ contact.email }}" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
            </div>
            
            <div class="form-group">
                <label for="telephone">ğŸ“± TÃ©lÃ©phone</label>
                <input type="tel" id="telephone" name="telephone" value="{{ contact.telephone }}" readonly style="background-color: #f5f5f5; cursor: not-allowed;">
            </div>
            {% else %}
            <!-- ADMIN/SUPER_ADMIN: Champs modifiables -->
            <div class="form-group">
                <label for="categorie">ğŸ“ CatÃ©gorie *</label>
                <select id="categorie" name="categorie" required>
                    <option value="Patient" {% if contact.categorie == 'Patient' %}selected{% endif %}>ğŸ‘¤ Patient</option>
                    <option value="Pharmacie" {% if contact.categorie == 'Pharmacie' %}selected{% endif %}>ğŸ’Š Pharmacie</option>
                    <option value="Fournisseur" {% if contact.categorie == 'Fournisseur' %}selected{% endif %}>ğŸ“¦ Fournisseur</option>
                    <option value="Partenaire" {% if contact.categorie == 'Partenaire' %}selected{% endif %}>ğŸ¤œ Partenaire</option>
                    <option value="Laboratoire" {% if contact.categorie == 'Laboratoire' %}selected{% endif %}>ğŸ”¬ Laboratoire</option>
                    <option value="Assurance" {% if contact.categorie == 'Assurance' %}selected{% endif %}>ğŸ›¡ï¸ Assurance</option>
                    <option value="Entreprise" {% if contact.categorie == 'Entreprise' %}selected{% endif %}>ğŸ¢ Entreprise</option>
                    <option value="Client" {% if contact.categorie == 'Client' %}selected{% endif %}>ğŸ’¼ Client</option>
                    <option value="Autre" {% if contact.categorie == 'Autre' %}selected{% endif %}>ğŸ“‹ Autre</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="nom" id="nom-label">
                    {% if categorie == 'Patient' %}
                    ğŸ‘¤ Nom Complet *
                    {% elif categorie == 'Pharmacie' %}
                    ğŸ’Š Nom de la Pharmacie *
                    {% elif categorie == 'Laboratoire' %}
                    ğŸ”¬ Nom du Laboratoire *
                    {% elif categorie == 'Assurance' %}
                    ğŸ›¡ï¸ Nom de l'Assurance *
                    {% elif categorie in ['Entreprise', 'Client', 'Fournisseur', 'Partenaire'] %}
                    ğŸ¢ Nom de l'Organisation *
                    {% else %}
                    ğŸ‘¤ Nom *
                    {% endif %}
                </label>
                <input type="text" id="nom" name="nom" value="{{ contact.nom }}" required autofocus>
            </div>
            
            <div class="form-group">
                <label for="email">ğŸ“§ Email *</label>
                <input type="email" id="email" name="email" value="{{ contact.email }}" required>
            </div>
            
            <div class="form-group">
                <label for="telephone">ğŸ“± TÃ©lÃ©phone *</label>
                <input type="tel" id="telephone" name="telephone" value="{{ contact.telephone }}" required placeholder="+212606060606">
                <small>Format international recommandÃ© pour WhatsApp</small>
            </div>
            
            <hr style="margin: 30px 0;" id="professional-section-divider">
            
            <div id="professional-section">
                <h3>
                    {% if categorie == 'Patient' %}
                    Informations Professionnelles (Optionnel)
                    {% elif categorie == 'Pharmacie' %}
                    Informations de la Pharmacie (Optionnel)
                    {% elif categorie == 'Laboratoire' %}
                    Informations du Laboratoire (Optionnel)
                    {% elif categorie == 'Assurance' %}
                    Informations de l'Assurance (Optionnel)
                    {% else %}
                    Informations Professionnelles (Optionnel)
                    {% endif %}
                </h3>
                
                <div class="form-group">
                    <label for="titre_poste" id="titre-poste-label">
                        {% if categorie == 'Patient' %}
                        ğŸ’¼ Profession
                        {% elif categorie == 'Pharmacie' %}
                        ğŸ‘¨â€âš•ï¸ Pharmacien Responsable
                        {% elif categorie == 'Laboratoire' %}
                        ğŸ‘¨â€ğŸ”¬ Directeur/Responsable
                        {% elif categorie == 'Assurance' %}
                        ğŸ‘¤ Responsable de Compte
                        {% elif categorie in ['Entreprise', 'Client', 'Fournisseur', 'Partenaire'] %}
                        ğŸ’¼ Personne de Contact / Poste
                        {% else %}
                        ğŸ’¼ Titre du Poste
                        {% endif %}
                    </label>
                    <input type="text" id="titre_poste" name="titre_poste" value="{{ contact.titre_poste or '' }}" 
                           placeholder="{% if categorie == 'Pharmacie' %}Ex: Dr. Mohammed Alami{% elif categorie == 'Laboratoire' %}Ex: Dr. Sarah Bennani{% else %}{% endif %}">
                </div>
            
                <div class="form-group" id="entreprise-group">
                    <label for="entreprise" id="entreprise-label">
                        {% if categorie == 'Patient' %}
                        ğŸ¢ Employeur
                        {% elif categorie in ['Entreprise', 'Client', 'Fournisseur', 'Partenaire'] %}
                        ğŸ¢ Nom de l'Entreprise
                        {% else %}
                        ğŸ¢ Organisation
                        {% endif %}
                    </label>
                    <input type="text" id="entreprise" name="entreprise" value="{{ contact.entreprise or '' }}">
                </div>
            </div>
            
            <hr style="margin: 30px 0;">
            
            <h3>
                {% if categorie in ['Pharmacie', 'Laboratoire', 'Assurance', 'Entreprise', 'Client', 'Fournisseur', 'Partenaire'] %}
                Adresse & Localisation (Optionnel)
                {% else %}
                Adresse (Optionnel)
                {% endif %}
            </h3>
            
            <div class="form-group">
                <label for="adresse">ğŸ  Adresse</label>
                <input type="text" id="adresse" name="adresse" value="{{ contact.adresse or '' }}">
            </div>
            
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px;">
                <div class="form-group">
                    <label for="ville">ğŸ™ï¸ Ville</label>
                    <input type="text" id="ville" name="ville" value="{{ contact.ville or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="code_postal">ğŸ“® Code Postal</label>
                    <input type="text" id="code_postal" name="code_postal" value="{{ contact.code_postal or '' }}">
                </div>
            </div>
            
            <div class="form-group">
                <label for="pays">ğŸŒ Pays</label>
                <input type="text" id="pays" name="pays" value="{{ contact.pays or 'Maroc' }}">
            </div>
            {% endif %}
            
            <hr style="margin: 30px 0;">
            
            {% if categorie == 'Patient' %}
            <!-- Section pour Patients -->
            <div id="medical-section">
                <h3>ğŸ¥ Informations MÃ©dicales (Optionnel)</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ‚ Date de Naissance</label>
                    <input type="date" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="groupe_sanguin">ğŸ©¸ Groupe Sanguin</label>
                    <select id="groupe_sanguin" name="groupe_sanguin">
                        <option value="">-- SÃ©lectionner --</option>
                        <option value="A+" {% if contact.groupe_sanguin == 'A+' %}selected{% endif %}>A+</option>
                        <option value="A-" {% if contact.groupe_sanguin == 'A-' %}selected{% endif %}>A-</option>
                        <option value="B+" {% if contact.groupe_sanguin == 'B+' %}selected{% endif %}>B+</option>
                        <option value="B-" {% if contact.groupe_sanguin == 'B-' %}selected{% endif %}>B-</option>
                        <option value="AB+" {% if contact.groupe_sanguin == 'AB+' %}selected{% endif %}>AB+</option>
                        <option value="AB-" {% if contact.groupe_sanguin == 'AB-' %}selected{% endif %}>AB-</option>
                        <option value="O+" {% if contact.groupe_sanguin == 'O+' %}selected{% endif %}>O+</option>
                        <option value="O-" {% if contact.groupe_sanguin == 'O-' %}selected{% endif %}>O-</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ”¢ NumÃ©ro de SÃ©curitÃ© Sociale</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="15">
                </div>
                
                <div class="form-group">
                    <label for="allergies">âš ï¸ Allergies</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: PÃ©nicilline, Arachides, etc.">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes MÃ©dicales</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Informations mÃ©dicales additionnelles...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie == 'Pharmacie' %}
            <!-- Section pour Pharmacie -->
            <div>
                <h3>ğŸ’Š Informations SpÃ©cifiques Pharmacie</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ• Horaires d'Ouverture</label>
                    <input type="text" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}" placeholder="Ex: Lun-Ven 8h-20h, Sam 9h-18h">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ“œ NÂ° Licence/AgrÃ©ment</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="NumÃ©ro d'autorisation officiel">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ’Š Services Disponibles</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: Garde 24h, OrthopÃ©die, HomÃ©opathie, MatÃ©riel mÃ©dical">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Informations complÃ©mentaires sur la pharmacie...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie == 'Laboratoire' %}
            <!-- Section pour Laboratoire -->
            <div>
                <h3>ğŸ”¬ Informations SpÃ©cifiques Laboratoire</h3>
                
                <div class="form-group">
                    <label for="date_naissance">â±ï¸ DÃ©lai de RÃ©sultats</label>
                    <input type="text" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}" placeholder="Ex: 24h pour analyses standard, 48h pour biologie">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ… NÂ° d'AccrÃ©ditation</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="NumÃ©ro d'accrÃ©ditation COFRAC ou Ã©quivalent">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ”¬ SpÃ©cialitÃ©s & Analyses</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: Biochimie, HÃ©matologie, Microbiologie, PCR, Imagerie mÃ©dicale">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Informations complÃ©mentaires, horaires, modalitÃ©s de prÃ©lÃ¨vement...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie == 'Assurance' %}
            <!-- Section pour Assurance -->
            <div>
                <h3>ğŸ›¡ï¸ Informations Contrat & Couverture</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ“… Date d'AdhÃ©sion</label>
                    <input type="date" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ“‹ NÂ° Police/Contrat</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="NumÃ©ro de contrat ou police d'assurance">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ›¡ï¸ Type de Couverture</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: Hospitalisation, Soins ambulatoires, Dentaire, Optique, MÃ©dicaments (taux %)">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Garanties spÃ©cifiques, exclusions, procÃ©dures de remboursement...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie == 'Fournisseur' %}
            <!-- Section pour Fournisseur -->
            <div>
                <h3>ğŸ“¦ Informations Commerciales</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ“… Date de DÃ©but Collaboration</label>
                    <input type="date" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ¢ NÂ° RC/Identifiant Fiscal</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="NumÃ©ro d'identification fiscale">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ“¦ Produits/Services Fournis</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: MÃ©dicaments, MatÃ©riel mÃ©dical, Fournitures bureau, Ã‰quipements">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Conditions de paiement, dÃ©lais de livraison, tarifs nÃ©gociÃ©s...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie == 'Partenaire' %}
            <!-- Section pour Partenaire -->
            <div>
                <h3>ğŸ¤ Informations Partenariat</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ“… Date de DÃ©but Partenariat</label>
                    <input type="date" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ“œ NÂ° Convention/Accord</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="RÃ©fÃ©rence de la convention ou accord">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ¤ Type de Partenariat</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: RÃ©fÃ©rencement mutuel, Co-marketing, Ã‰change de services, R&D">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Termes du partenariat, objectifs communs, engagements...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% elif categorie in ['Entreprise', 'Client'] %}
            <!-- Section pour Entreprise/Client -->
            <div>
                <h3>ğŸ¢ Informations Commerciales</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ“… Date de DÃ©but Relation</label>
                    <input type="date" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ¢ NÂ° SIRET/Client</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50" placeholder="NumÃ©ro d'identification">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ­ Secteur d'ActivitÃ©</label>
                    <textarea id="allergies" name="allergies" rows="3" placeholder="Ex: SantÃ©, Technologie, Commerce, Services, Industrie">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Besoins spÃ©cifiques, historique des transactions, prÃ©fÃ©rences...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            
            {% else %}
            <!-- Section par dÃ©faut -->
            <div>
                <h3>ğŸ“‹ Informations ComplÃ©mentaires</h3>
                
                <div class="form-group">
                    <label for="date_naissance">ğŸ“… Date</label>
                    <input type="text" id="date_naissance" name="date_naissance" value="{{ contact.date_naissance or '' }}">
                </div>
                
                <div class="form-group">
                    <label for="numero_secu">ğŸ”¢ NumÃ©ro/ID</label>
                    <input type="text" id="numero_secu" name="numero_secu" value="{{ contact.numero_secu or '' }}" maxlength="50">
                </div>
                
                <div class="form-group">
                    <label for="allergies">ğŸ“Œ DÃ©tails</label>
                    <textarea id="allergies" name="allergies" rows="3">{{ contact.allergies or '' }}</textarea>
                </div>
                
                <div class="form-group">
                    <label for="notes">ğŸ“ Notes</label>
                    <textarea id="notes" name="notes" rows="4" placeholder="Informations additionnelles...">{{ contact.notes or '' }}</textarea>
                </div>
            </div>
            {% endif %}
            
            <div class="form-actions">
                <button type="submit" class="btn btn-success">âœ“ Enregistrer les Modifications</button>
                <a href="{{ url_for('contacts') }}" class="btn btn-secondary">âœ— Annuler</a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const categorieSelect = document.getElementById('categorie');
    // Note: Les sections mÃ©dicales/commerciales sont maintenant gÃ©rÃ©es cÃ´tÃ© serveur
    
    // Fonction pour mettre Ã  jour les labels selon la catÃ©gorie
    function updateLabels(categorie) {
        if (!categorieSelect) return; // Si USER (champs en lecture seule)
        
        const nomLabel = document.getElementById('nom-label');
        const titrePosteLabel = document.getElementById('titre-poste-label');
        const entrepriseLabel = document.getElementById('entreprise-label');
        const professionalSection = document.querySelector('#professional-section h3');
        
        // Mettre Ã  jour le label du nom
        if (nomLabel) {
            switch(categorie) {
                case 'Patient':
                    nomLabel.innerHTML = 'ğŸ‘¤ Nom Complet *';
                    break;
                case 'Pharmacie':
                    nomLabel.innerHTML = 'ğŸ’Š Nom de la Pharmacie *';
                    break;
                case 'Laboratoire':
                    nomLabel.innerHTML = 'ğŸ”¬ Nom du Laboratoire *';
                    break;
                case 'Assurance':
                    nomLabel.innerHTML = 'ğŸ›¡ï¸ Nom de l\'Assurance *';
                    break;
                case 'Entreprise':
                case 'Client':
                case 'Fournisseur':
                case 'Partenaire':
                    nomLabel.innerHTML = 'ğŸ¢ Nom de l\'Organisation *';
                    break;
                default:
                    nomLabel.innerHTML = 'ğŸ‘¤ Nom *';
            }
        }
        
        // Mettre Ã  jour le label du titre/poste
        if (titrePosteLabel) {
            switch(categorie) {
                case 'Patient':
                    titrePosteLabel.innerHTML = 'ğŸ’¼ Profession';
                    break;
                case 'Pharmacie':
                    titrePosteLabel.innerHTML = 'ğŸ‘¨â€âš•ï¸ Pharmacien Responsable';
                    break;
                case 'Laboratoire':
                    titrePosteLabel.innerHTML = 'ğŸ‘¨â€ğŸ”¬ Directeur/Responsable';
                    break;
                case 'Assurance':
                    titrePosteLabel.innerHTML = 'ğŸ‘¤ Responsable de Compte';
                    break;
                case 'Entreprise':
                case 'Client':
                case 'Fournisseur':
                case 'Partenaire':
                    titrePosteLabel.innerHTML = 'ğŸ’¼ Personne de Contact / Poste';
                    break;
                default:
                    titrePosteLabel.innerHTML = 'ğŸ’¼ Titre du Poste';
            }
        }
        
        // Mettre Ã  jour le label de l'entreprise
        if (entrepriseLabel) {
            switch(categorie) {
                case 'Patient':
                    entrepriseLabel.innerHTML = 'ğŸ¢ Employeur';
                    break;
                case 'Entreprise':
                case 'Client':
                case 'Fournisseur':
                case 'Partenaire':
                    entrepriseLabel.innerHTML = 'ğŸ¢ Nom de l\'Entreprise';
                    break;
                default:
                    entrepriseLabel.innerHTML = 'ğŸ¢ Organisation';
            }
        }
        
        // Mettre Ã  jour le titre de la section professionnelle
        if (professionalSection) {
            switch(categorie) {
                case 'Patient':
                    professionalSection.textContent = 'Informations Professionnelles (Optionnel)';
                    break;
                case 'Pharmacie':
                    professionalSection.textContent = 'Informations de la Pharmacie (Optionnel)';
                    break;
                case 'Laboratoire':
                    professionalSection.textContent = 'Informations du Laboratoire (Optionnel)';
                    break;
                case 'Assurance':
                    professionalSection.textContent = 'Informations de l\'Assurance (Optionnel)';
                    break;
                default:
                    professionalSection.textContent = 'Informations Professionnelles (Optionnel)';
            }
        }
    }
    
    // Note: Les champs spÃ©cifiques Ã  chaque catÃ©gorie sont maintenant gÃ©rÃ©s cÃ´tÃ© serveur
    // Cette fonction n'est plus nÃ©cessaire pour la section mÃ©dicale/commerciale
    
    // Fonction pour mettre Ã  jour les labels selon la catÃ©gorie (pour admin uniquement)
    function updateSectionsVisibility() {
        if (!categorieSelect) return; // Si USER (champs en lecture seule)
        
        const categorie = categorieSelect.value;
        
        // Mettre Ã  jour les labels de la section professionnelle
        updateLabels(categorie);
        
        // Note: Les champs spÃ©cifiques sont maintenant gÃ©rÃ©s cÃ´tÃ© serveur
        // L'admin doit enregistrer pour voir les changements de section
    }
    
    // Initialiser au chargement de la page
    updateSectionsVisibility();
    
    // Ã‰couter les changements de catÃ©gorie
    if (categorieSelect) {
        categorieSelect.addEventListener('change', updateSectionsVisibility);
    }
});
</script>

{% endblock %}
